{% extends 'store/base_shop.html' %}
{% load math_filters %}
{% load i18n %}
{% load custom_filters %}

{% block title %}
  {% trans "Chi tiáº¿t Ä‘Æ¡n hÃ ng" %}
{% endblock %}

{% block content %}
<div class="container py-5">
  <div class="text-center mb-5">
    <h2 class="fw-bold">ğŸ“‹ {% trans "Chi tiáº¿t Ä‘Æ¡n hÃ ng" %} <span class="text-primary">#{{ order.id }}</span></h2>
    <p class="text-muted">{% trans "ThÃ´ng tin chi tiáº¿t Ä‘Æ¡n hÃ ng báº¡n Ä‘Ã£ Ä‘áº·t" %}</p>
  </div>

  <div class="card shadow-lg border-0 rounded-4">
    <div class="card-body p-4">

      <div class="row mb-4">
        <div class="col-md-6">
          <p><i class="bi bi-calendar-event"></i> <strong>{% trans "NgÃ y táº¡o" %}:</strong> {{ order.created_at|date:"d/m/Y H:i" }}</p>
        </div>
        <div class="col-md-6 text-md-end">
          <p>
            <i class="bi bi-info-circle"></i> <strong>{% trans "Tráº¡ng thÃ¡i" %}:</strong>
            {% if order.status != 'pending' %}
              <span class="badge bg-success px-3 py-2 fs-6">âœ… {% trans "ÄÃ£ thanh toÃ¡n" %}</span>
            {% else %}
              <span class="badge bg-warning text-dark px-3 py-2 fs-6">â³ {% trans "ChÆ°a thanh toÃ¡n" %}</span>
            {% endif %}
          </p>
        </div>
      </div>

      {% if order.status == 'pending' %}
      <div class="alert alert-info text-center">
        <p class="mb-2 fw-semibold">ğŸ’³ {% trans "Vui lÃ²ng quÃ©t mÃ£ QR bÃªn dÆ°á»›i Ä‘á»ƒ thanh toÃ¡n" %}:</p>
        <img src="{{ order.qr_code_url }}" alt="{% trans 'MÃ£ QR thanh toÃ¡n' %}" class="img-fluid rounded" style="max-width: 250px;">
        <p class="mt-2 text-muted"><small>{% trans "ÄÆ¡n hÃ ng sáº½ tá»± Ä‘á»™ng xÃ¡c nháº­n sau khi báº¡n thanh toÃ¡n thÃ nh cÃ´ng." %}</small></p>
      </div>
      {% endif %}

      <h5 class="fw-bold mt-4 mb-3">ğŸ›’ {% trans "Sáº£n pháº©m trong Ä‘Æ¡n" %}</h5>
      <div class="table-responsive">
        <table class="table table-bordered table-hover align-middle shadow-sm">
          <thead class="table-light text-center">
            <tr>
              <th>{% trans "Sáº£n pháº©m" %}</th>
              <th>{% trans "ÄÆ¡n giÃ¡" %}</th>
              <th>{% trans "Sá»‘ lÆ°á»£ng" %}</th>
              <th>{% trans "ThÃ nh tiá»n" %}</th>
            </tr>
          </thead>
          <tbody>
            {% for item in order.items.all %}
            <tr>
              <td>{{ item.product.name }}</td>
              <td class="text-end">{{ item.price|format_price }}â‚«</td>
              <td class="text-center">{{ item.quantity }}</td>
              <td class="text-end text-danger fw-bold">{{ item.price|mul:item.quantity|format_price }}â‚«</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <div class="text-end mt-4">
        <h5 class="fw-bold">{% trans "Tá»•ng tiá»n" %}: <span class="text-danger fs-4">{{ order.total_amount|format_price }}â‚«</span></h5>
      </div>

      <div class="text-center mt-5">
        <a href="{% url 'order_list' %}" class="btn btn-outline-primary px-4 py-2 rounded-pill">
          â† {% trans "Quay láº¡i danh sÃ¡ch Ä‘Æ¡n hÃ ng" %}
        </a>
      </div>

    </div>
  </div>
</div>
{% endblock %}
