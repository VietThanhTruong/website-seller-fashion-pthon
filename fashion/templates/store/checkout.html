{% extends 'store/base_shop.html' %}
{% load i18n %}
{% block title %}{% trans "Thanh To√°n" %}{% endblock %}
{% load static %}
{% load humanize %}

{% block content %}
<style>
  .copy-btn {
    font-size: 0.8rem;
    background-color: #16ab651a;
    border: none;
    color: #555;
    padding: 0.25rem 0.6rem;
    border-radius: 0.35rem;
    cursor: pointer;
  }
  .copy-btn:hover {
    background-color: #d4f0d4;
    color: #2d7a2d;
  }
  .info-label {
    color: #555;
    font-size: 0.9rem;
  }
  .info-value {
    font-weight: 600;
    font-size: 1rem;
  }
</style>
<div class="container py-4">
  <input type="hidden" name="oder_key" value="{{data.oderKey}}" />
  <h3 class="text-center fw-bold mb-4">üßæ {% trans "X√°c nh·∫≠n thanh to√°n" %}</h3>

  <div class="d-flex justify-content-center align-items-center mb-3 gap-2">
    <img
      src="https://pay.payos.vn/images/lamp.svg"
      alt="Lamp Icon"
      width="32"
      height="32"
    />
    <p class="mb-0 small text-muted text-center">
      {% trans "M·ªü App Ng√¢n h√†ng ƒë·ªÉ" %} <b>{% trans "qu√©t m√£ VietQR" %}</b> {% trans "ho·∫∑c" %} {" "}
      <b>{% trans "chuy·ªÉn kho·∫£n ch√≠nh x√°c s·ªë ti·ªÅn b√™n d∆∞·ªõi" %}</b>
    </p>
  </div>

  <div class="row gy-4 align-items-center">
    <div class="col-md-6 text-center">
      <img
        src="{{ data.qrCode }}"
        alt="QR Code"
        class="img-fluid rounded shadow-sm"
        style="max-width: 300px"
      />
    </div>

    <div class="col-md-6">
      <div class="d-flex align-items-center mb-3">
        <img
          src="{{ data.icon }}"
          alt="Bank Icon"
          width="40"
          height="40"
          class="rounded-circle me-3"
        />
        <div>
          <p class="info-label mb-0">{% trans "Ng√¢n h√†ng" %}</p>
          <p class="info-value mb-0">{{ data.description }}</p>
        </div>
      </div>

      <div class="mb-3">
        <p class="info-label mb-1">{% trans "Ch·ªß t√†i kho·∫£n:" %}</p>
        <p class="info-value mb-0">PHAM LE XUAN TRUONG</p>
      </div>

      <div class="mb-3 d-flex justify-content-between align-items-center">
        <div>
          <p class="info-label mb-1">{% trans "S·ªë t√†i kho·∫£n:" %}</p>
          <p class="info-value mb-0">{{ data.stk }}</p>
        </div>
        <button
          type="button"
          class="copy-btn"
          onclick="copyText('{{ data.stk }}')"
        >
          {% trans "Sao ch√©p" %}
        </button>
      </div>

      <div class="mb-3 d-flex justify-content-between align-items-center">
        <div>
          <p class="info-label mb-1">{% trans "S·ªë ti·ªÅn:" %}</p>
          <p class="info-value mb-0">
            {{ data.amount|intcomma }} VNƒê
          </p>
        </div>
        <button
          type="button"
          class="copy-btn"
          onclick="copyText('{{ data.amount }}')"
        >
          {% trans "Sao ch√©p" %}
        </button>
      </div>

      <div class="mb-4 d-flex justify-content-between align-items-center">
        <div>
          <p class="info-label mb-1">{% trans "N·ªôi dung:" %}</p>
          <p class="info-value mb-0">{{ data.transactionContent }}</p>
        </div>
        <button
          type="button"
          class="copy-btn"
          onclick="copyText('{{ data.transactionContent }}')"
        >
          {% trans "Sao ch√©p" %}
        </button>
      </div>

      <div class="text-center">
        {% if data.status_text == "pending" %}
        <div
          class="alert alert-info d-flex align-items-center justify-content-center"
        >
          <div
            class="spinner-border spinner-border-sm me-2"
            role="status"
            aria-hidden="true"
          ></div>
          {% trans "ƒêang ki·ªÉm tra giao d·ªãch..." %}
        </div>
        {% elif data.status_text == "success" %}
        <div
          class="alert alert-success d-flex align-items-center justify-content-center"
        >
          <i class="fas fa-check-circle me-2"></i>
          {% trans "Giao d·ªãch ƒë√£ ho√†n t·∫•t!" %}
        </div>
        {% elif data.status_text == "failed" %}
        <div
          class="alert alert-danger d-flex align-items-center justify-content-center"
        >
          <i class="fas fa-times-circle me-2"></i>
          {% trans "Giao d·ªãch th·∫•t b·∫°i!" %}
        </div>
        {% endif %}
      </div>
    </div>
  </div>

  <div
    class="d-flex flex-column flex-md-row justify-content-between align-items-center mt-4"
  >
    <p class="mb-3 mb-md-0 text-muted small">
      {% trans "L∆∞u √Ω: Nh·∫≠p ch√≠nh x√°c" %} <b>{% trans "s·ªë ti·ªÅn" %}</b> {% trans
      "v√†" %} <b>{% trans "n·ªôi dung" %}</b> {% trans "khi chuy·ªÉn kho·∫£n" %}
    </p>
    <button
      type="button"
      class="btn btn-outline-secondary"
      onclick="window.history.back()"
    >
      {% trans "Hu·ª∑" %}
    </button>
  </div>
</div>

<script
  src="https://kit.fontawesome.com/a076d05399.js"
  crossorigin="anonymous"
></script>

<script>
  function copyText(value) {
    navigator.clipboard.writeText(value).then(() => {
      alert("{% trans 'ƒê√£ sao ch√©p: ' %}" + value);
    }, () => {
      alert("{% trans 'Kh√¥ng th·ªÉ sao ch√©p!' %}");
    });
  }
</script>

{% endblock %}
