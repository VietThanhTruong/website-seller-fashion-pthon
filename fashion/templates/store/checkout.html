{% extends 'store/base_shop.html' %}
{% block title %}Gi·ªè h√†ng{% endblock %}
{% load static %}
{% load humanize %}

{% block content %}
  <style>
    .copy-btn {
      font-size: 0.8rem;
      background-color: #16ab651a;
      border: none;
      color: #555;
      padding: 0.25rem 0.6rem;
      border-radius: 0.35rem;
      cursor: pointer;
    }
    .copy-btn:hover {
      background-color: #d4f0d4;
      color: #2d7a2d;
    }
    .info-label {
      color: #555;
      font-size: 0.9rem;
    }
    .info-value {
      font-weight: 600;
      font-size: 1rem;
    }
  </style>
  <div class="container py-4">
    <h3 class="text-center fw-bold mb-4">üßæ X√°c nh·∫≠n thanh to√°n</h3>

    <div class="d-flex justify-content-center align-items-center mb-3 gap-2">
      <img
        src="https://pay.payos.vn/images/lamp.svg"
        alt="Lamp Icon"
        width="32"
        height="32"
      />
      <p class="mb-0 small text-muted text-center">
        M·ªü App Ng√¢n h√†ng ƒë·ªÉ <b>qu√©t m√£ VietQR</b> ho·∫∑c {" "}
        <b>chuy·ªÉn kho·∫£n ch√≠nh x√°c s·ªë ti·ªÅn b√™n d∆∞·ªõi</b>
      </p>
    </div>

    <div class="row gy-4 align-items-center">
      <div class="col-md-6 text-center">
        <img
          src="{{ data.qrCode }}"
          alt="QR Code"
          class="img-fluid rounded shadow-sm"
          style="max-width: 300px;"
        />
      </div>

      <div class="col-md-6">
        <div class="d-flex align-items-center mb-3">
          <img
            src="{{ data.icon }}"
            alt="Bank Icon"
            width="40"
            height="40"
            class="rounded-circle me-3"
          />
          <div>
            <p class="info-label mb-0">Ng√¢n h√†ng</p>
            <p class="info-value mb-0">{{ data.description }}</p>
          </div>
        </div>

        <div class="mb-3">
          <p class="info-label mb-1">Ch·ªß t√†i kho·∫£n:</p>
          <p class="info-value mb-0">PHAM LE XUAN TRUONG</p>
        </div>

        <div class="mb-3 d-flex justify-content-between align-items-center">
          <div>
            <p class="info-label mb-1">S·ªë t√†i kho·∫£n:</p>
            <p class="info-value mb-0">{{ data.stk }}</p>
          </div>
          <button
            type="button"
            class="copy-btn"
            onclick="copyText('{{ data.stk }}')"
          >
            Sao ch√©p
          </button>
        </div>

        <div class="mb-3 d-flex justify-content-between align-items-center">
          <div>
            <p class="info-label mb-1">S·ªë ti·ªÅn:</p>
            <p class="info-value mb-0">{{ data.amount|intcomma }} VNƒê</p>
          </div>
          <button
            type="button"
            class="copy-btn"
            onclick="copyText('{{ data.amount }}')"
          >
            Sao ch√©p
          </button>
        </div>

        <div class="mb-4 d-flex justify-content-between align-items-center">
          <div>
            <p class="info-label mb-1">N·ªôi dung:</p>
            <p class="info-value mb-0">{{ data.transactionContent }}</p>
          </div>
          <button
            type="button"
            class="copy-btn"
            onclick="copyText('{{ data.transactionContent }}')"
          >
            Sao ch√©p
          </button>
        </div>

        <div class="text-center">
          {% if data.status_text == "pending" %}
            <div class="alert alert-info d-flex align-items-center justify-content-center">
              <div class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></div>
              ƒêang ki·ªÉm tra giao d·ªãch...
            </div>
          {% elif data.status_text == "success" %}
            <div class="alert alert-success d-flex align-items-center justify-content-center">
              <i class="fas fa-check-circle me-2"></i>
              Giao d·ªãch ƒë√£ ho√†n t·∫•t!
            </div>
          {% elif data.status_text == "failed" %}
            <div class="alert alert-danger d-flex align-items-center justify-content-center">
              <i class="fas fa-times-circle me-2"></i>
              Giao d·ªãch th·∫•t b·∫°i!
            </div>
          {% endif %}
        </div>
      </div>
    </div>

    <div class="d-flex flex-column flex-md-row justify-content-between align-items-center mt-4">
      <p class="mb-3 mb-md-0 text-muted small">
        L∆∞u √Ω: Nh·∫≠p ch√≠nh x√°c <b>s·ªë ti·ªÅn</b> v√† <b>n·ªôi dung</b> khi chuy·ªÉn kho·∫£n
      </p>
      <button
        type="button"
        class="btn btn-outline-secondary"
        onclick="window.history.back()"
      >
        Hu·ª∑
      </button>
    </div>
  </div>
  <div class="list-group">
    {% for item in items %}
    <div
      class="list-group-item bg-light rounded shadow-sm mb-3 p-3"
      id="cart-item-{{ item.id }}"
    >
      <div
        class="d-flex flex-md-row justify-content-between align-items-center"
      >
        <div class="d-flex align-items-center mb-3 mb-md-0">
          <img
            src="{{ item.product.image.url }}"
            alt="{{ item.product.name }}"
            class="rounded shadow-sm me-3"
            style="width: 50px; height: 50px; object-fit: cover"
          />
          <div>
            <h6 class="mb-1 mb-sm-0">{{ item.product.name }}</h6>
            <div class="text-danger fw-semibold small">
              {{ item.total_price|intcomma }}ƒë
            </div>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>

  <script
    src="https://kit.fontawesome.com/a076d05399.js"
    crossorigin="anonymous"
  ></script>
  
  <script>
    function copyText(value) {
      navigator.clipboard.writeText(value).then(() => {
        alert("ƒê√£ sao ch√©p: " + value);
      }, () => {
        alert("Kh√¥ng th·ªÉ sao ch√©p!");
      });
    }
  </script>

{% endblock %}